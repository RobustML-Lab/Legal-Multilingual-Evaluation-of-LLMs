from Pipeline.utils import get_embedding_bert
from Pipeline.data import Eur_Lex_Sum
from sklearn.metrics.pairwise import cosine_similarity
reference = "Prospectus to be published when securities are<br>offered to the public or admitted to trading on a<br>regulated market Prospectus to be published when<br>securities are offered to the public or admitted<br>to trading on a regulated market SUMMARY OF:<br>Regulation (EU) 2017/1129 on the prospectus to be<br>published when securities are offered to the<br>public or admitted to trading on a regulated<br>market Delegated Regulation (EU) 2019/979<br>supplementing Regulation (EU) 2017/1129 on<br>regulatory technical standards on key financial<br>information in the summary of a prospectus, the<br>publication and classification of prospectuses,<br>advertisements for securities, supplements to a<br>prospectus, and the notification portal Delegated<br>Regulation (EU) 2019/980 supplementing Regulation<br>(EU) 2017/1129 on format, content, scrutiny and<br>approval of the prospectus to be published when<br>securities are offered to the public or admitted<br>to trading on a regulated market Delegated<br>Regulation (EU) 2021/528 supplementing Regulation<br>(EU) 2017/1129 on the minimum information content<br>of the document to be published for a prospectus<br>exemption in connection with a takeover by means<br>of an exchange offer, a merger or a division WHAT<br>IS THE AIM OF THE REGULATION? Regulation (EU)<br>2017/1129 (the prospectus regulation), as<br>supplemented by Delegated Regulations (EU)<br>2019/979, 2019/980 and 2019/528, aims to help<br>companies, including small and medium-sized<br>enterprises (SMEs), access different forms of<br>finance in the European Union (EU). It does so by<br>simplifying and streamlining the rules and<br>procedures for drawing up, approving and<br>distributing the prospectus* they publish when<br>offering securities* to the public or admitting<br>securities to trading on a regulated market. The<br>legislation reduces costly and burdensome red tape<br>for companies and enables investors to make the<br>right investment decision by providing<br>comprehensible, easy to analyse and concise<br>information. KEY POINTS                The<br>regulation: removes the need for a prospectus for<br>any offer of securities to the public, including<br>crowdfunding (raising money from a large group of<br>people, often via the internet) projects, below €1<br>million (previously the limit was €100,000);<br>allows EU Member States to be exempt from the need<br>for a prospectus for offers of securities to the<br>public of up to €8 million, provided that they do<br>not require notification (a ‘passport’); sets out<br>rules to curb the tendency to overload<br>prospectuses with generic risk factors;<br>strengthens supervisory convergence by harmonising<br>scrutiny and approval of prospectuses (including<br>the applicable timelines) throughout the EU;<br>enables companies that frequently issue securities<br>to use the universal registration document to<br>secure fast-track approval from supervisors within<br>5 days; introduces a European online database,<br>operated free of charge by the European Securities<br>and Markets Authority (ESMA), containing all<br>prospectuses approved in the European Economic<br>Area. The regulation requires a prospectus to<br>enable an investor to make an informed decision.<br>It must include: assets, liabilities, profits,<br>losses, financial position and prospects for the<br>issuer and any guarantor; rights attached to the<br>securities; reasons for issuing the securities and<br>their impact on the issuer; a clear and accurate<br>seven-page summary (except for the admission to<br>trading of non-equity securities only targeting<br>qualified investors), which provides: an<br>introduction with warnings that the investor could<br>lose all or part of the invested capital,key<br>information on the securities, including the type<br>and class of securities and the rights attached to<br>the securities,information about the issuer,a<br>brief description of the nature and scope of a<br>guarantee. The regulation establishes a<br>standardised and simplified EU growth prospectus<br>for: SMEs, defined in Directive 2014/65/EU (the<br>MiFID II directive) (see summary) as companies<br>which meet at least two of the following three<br>criteria: an average number of employees during<br>the financial year of less than 250,a total<br>balance sheet not exceeding €43 million,an annual<br>net turnover not exceeding €50 million; issuers,<br>other than SMEs, whose securities are traded or to<br>be traded on an SME growth market (a market that<br>offers access to capital for SMEs), with an<br>average market capitalisation (market value of the<br>company’s shares) of below €500 million; offerors<br>of securities issued by issuers referred to in the<br>two previous points; non-listed companies (not<br>listed on any stock market) which offer securities<br>to the public of less than €20 million in any<br>given 12 months, provided that they have fewer<br>than 500 employees; issuers, other than SMEs, that<br>offer shares to the public and at the same time<br>seek admission of those shares to trading on an<br>SME growth market, provided that: such issuers<br>have no shares already admitted to trading on an<br>SME growth market,the combined value of the final<br>offer price (or, if not available, the maximum<br>price) and the total number of shares outstanding<br>immediately after the share offer to the public is<br>less than €200 million. The abovementioned<br>companies can benefit from this tailored<br>prospectus provided that they have no securities<br>admitted to trading on a regulated market. The<br>regulation provides for a simplified prospectus<br>for companies listed for at least 18 months on a<br>regulated market or an SME growth market and<br>wishing to issue additional shares or raise debt<br>(secondary issuance). The regulation harmonises<br>the minimum information content of the document to<br>be published for a prospectus exemption in<br>connection with a takeover by means of an exchange<br>offer, a merger or a division. Amending<br>regulations Regulation (EU) 2019/2115 seeks to<br>promote the use of SME growth markets by reducing<br>formalities and administrative burdens on SMEs in<br>terms of disclosure obligations and a simplified<br>prospectus. Regulation (EU) 2020/1503 introduces a<br>prospectus exemption for offers of securities to<br>the public made by crowdfunding service providers<br>that do not exceed the threshold of €5 million in<br>accordance with the conditions specified in that<br>regulation. Regulation (EU) 2021/337 introduces a<br>new ‘EU recovery prospectus’ to help companies<br>recover from the COVID-19 crisis. This shorter<br>prospectus, with a maximum length of 30 pages plus<br>a two-page summary, makes it easier for companies<br>to raise capital to meet their funding needs,<br>while ensuring adequate information is provided to<br>investors. The recovery prospectus will be<br>available for capital increases of up to 150% of<br>outstanding capital within a period of 12 months<br>and applies until the end of 2022. Delegated acts<br>The European Commission has adopted the following<br>acts. Delegated Regulation (EU) 2019/980 laying<br>down details of the precise content and format of<br>the prospectus, as well as concerning the scrutiny<br>and approval of the prospectus. Delegated<br>Regulation (EU) 2019/979 laying down details of<br>the key financial information in the summary of<br>the prospectus, the publication and classification<br>of the prospectus, the advertisement for the<br>securities and the supplement to a prospectus.<br>Delegated Regulation (EU) 2020/1273 amending and<br>correcting Delegated Regulation (EU) 2019/980.<br>Delegated Regulation (EU) 2020/1272 amending and<br>correcting Delegated Regulation (EU) 2019/979.<br>Delegated Regulation (EU) 2021/528 setting out the<br>minimum information content of the document to be<br>published for a prospectus exemption in connection<br>with a takeover by means of an exchange offer, a<br>merger or a division. Report The Commission is<br>required to report on the application of the<br>legislation before 21 July 2022. FROM WHEN DO THE<br>REGULATIONS APPLY? Regulation (EU) 2017/1129 and<br>Delegated Regulations (EU) 2019/979 and (EU)<br>2019/980 have applied since 21 July 2019.<br>Delegated Regulation (EU) 2021/528 has applied<br>since 15 April 2021. BACKGROUND Directive<br>2003/71/EC was designed to make it easier for<br>companies to raise capital throughout the EU on<br>the basis of approval from just one national<br>supervisor. This gave a ‘passport’ for<br>prospectuses containing cross-border offers.<br>Regulation (EU) 2017/1129, which repeals and<br>replaces Directive 2003/71/EEC, addresses the<br>areas of legal uncertainty and unjustified<br>administrative burdens which had emerged over<br>time. It is considered a major milestone towards a<br>European capital markets union. For further<br>information, see: Securities prospectus (European<br>Commission) Prospectus (European Securities and<br>Markets Authority). KEY TERMS<br>Prospectus. A legal document describing a<br>company’s main line of business, finances and<br>shareholding structure. Potential investors use it<br>to decide whether to buy the securities a company<br>offers. Securities. Shares, bonds and derivatives.<br>MAIN DOCUMENTS              Regulation (EU)<br>2017/1129 of the European Parliament and of the<br>Council of 14 June 2017 on the prospectus to be<br>published when securities are offered to the<br>public or admitted to trading on a regulated<br>market, and repealing Directive 2003/71/EC (OJ L<br>168, 30.6.2017, pp. 12–82). Successive amendments<br>to Regulation (EU) 2017/1129 have been<br>incorporated in the original text. This<br>consolidated version is of documentary value only.<br>Commission Delegated Regulation (EU) 2019/979 of<br>14 March 2019 supplementing Regulation (EU)<br>2017/1129 of the European Parliament and of the<br>Council with regard to regulatory technical<br>standards on key financial information in the<br>summary of a prospectus, the publication and<br>classification of prospectuses, advertisements for<br>securities, supplements to a prospectus, and the<br>notification portal, and repealing Commission<br>Delegated Regulation (EU) No 382/2014 and<br>Commission Delegated Regulation (EU) 2016/301 (OJ<br>L 166, 21.6.2019, pp. 1–25). See consolidated<br>version. Commission Delegated Regulation (EU)<br>2019/980 of 14 March 2019 supplementing Regulation<br>(EU) 2017/1129 of the European Parliament and of<br>the Council as regards the format, content,<br>scrutiny and approval of the prospectus to be<br>published when securities are offered to the<br>public or admitted to trading on a regulated<br>market, and repealing Commission Regulation (EC)<br>No 809/2004 (OJ L 166, 21.6.2019, pp. 26–176). See<br>consolidated version. Commission Delegated<br>Regulation (EU) 2021/528 of 16 December 2020<br>supplementing Regulation (EU) 2017/1129 of the<br>European Parliament and of the Council as regards<br>the minimum information content of the document to<br>be published for a prospectus exemption in<br>connection with a takeover by means of an exchange<br>offer, a merger or a division (OJ L 106,<br>26.3.2021, pp. 32–46). RELATED DOCUMENTS<br>Regulation (EU) 2021/337 of the European<br>Parliament and of the Council of 16 February 2021<br>amending Regulation (EU) 2017/1129 as regards the<br>EU Recovery prospectus and targeted adjustments<br>for financial intermediaries and Directive<br>2004/109/EC as regards the use of the single<br>electronic reporting format for annual financial<br>reports, to support the recovery from the COVID-19<br>crisis (OJ L 68, 26.2.2021, pp. 1–13). Regulation<br>(EU) 2020/1503 of the European Parliament and of<br>the Council of 7 October 2020 on European<br>crowdfunding service providers for business, and<br>amending Regulation (EU) 2017/1129 and Directive<br>(EU) 2019/1937 (OJ L 347, 20.10.2020, pp. 1–49).<br>Regulation (EU) 2019/2115 of the European<br>Parliament and of the Council of 27 November 2019<br>amending Directive 2014/65/EU and Regulations (EU)<br>No 596/2014 and (EU) 2017/1129 as regards the<br>promotion of the use of SME growth markets (OJ L<br>320, 11.12.2019, pp. 1–10). last update 22.11.2021"
summary = "The document appears to be a template for a<br>prospectus or offering circular, used in various<br>jurisdictions to disclose information about an<br>investment opportunity. It covers several key<br>aspects of the offering, including:  1. Investor<br>categories and exclusions 2. Plan of distribution<br>and allotment (including pricing, underwriting,<br>and listing) 3. Notifying applicants of allotted<br>amounts and dealing arrangements 4. Expenses and<br>taxes charged to subscribers or purchasers 5.<br>Placing and underwriting details (including<br>coordinator(s), paying agents, and depository<br>agents) 6. Admission to trading and dealing<br>arrangements (including SME growth Markets and<br>MTFs)  The document also includes additional<br>information sections:  1. Guarantor information<br>(if applicable) 2. Annex 28: List of additional<br>information in the final terms (such as examples<br>of complex derivative securities, underlying<br>provisions, countries where the offer takes place,<br>etc.) 3. Annex 29: List of specialist issuers<br>(including property companies, mineral companies,<br>investment companies, scientific research-based<br>companies, start-up companies, and shipping<br>companies)  Overall, the document aims to provide<br>detailed information about an investment<br>opportunity, ensuring transparency and compliance<br>with relevant regulations."
dataset = Eur_Lex_Sum()
data, prompt = dataset.get_data("english", "", 1)
text = data[0]['text']
embedded_reference = get_embedding_bert(reference)
embedded_summary = get_embedding_bert(summary)
embedded_text = get_embedding_bert(text)
print(embedded_text)
cosine_similarity_rs = cosine_similarity(embedded_reference, embedded_summary)
cosine_similarity_tr = cosine_similarity(embedded_reference, embedded_text)
cosine_similarity_st = cosine_similarity(embedded_text, embedded_summary)

print(cosine_similarity_rs, cosine_similarity_tr, cosine_similarity_st)
